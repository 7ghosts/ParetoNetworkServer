<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>P A R E T O .</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico in the root directory -->
        <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
        <link rel="manifest" href="manifest.json">
        <link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
        <meta name="theme-color" content="#ffffff">

        <link rel="stylesheet" href="static/css/general.css">
        <link rel="stylesheet" href="static/css/custom.css">

        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

    </head>
    <body style="overflow: scroll">
        <div style="position: fixed; width: 100%;">
        	<div id="gradient" class="row" style="vertical-align: top;
        		height: 5px; 
        		background: #295087; /* Old browsers */
    			background: -moz-linear-gradient(left, #295087 0%, #3f7989 50%, #6aba82 77%, #85c568 100%); /* FF3.6-15 */
    			background: -webkit-linear-gradient(left, #295087 0%,#3f7989 50%,#6aba82 77%,#85c568 100%); /* Chrome10-25,Safari5.1-6 */
    			background: linear-gradient(to right, #295087 0%,#3f7989 50%,#6aba82 77%,#85c568 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
    			filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#295087', endColorstr='#85c568',GradientType=1 ); /* IE6-9 */
                ">&nbsp;</div>

            <nav class="navbar navbar-default font-body" style="background-color: #040f1e; color: #ffffff;">
              <div class="container-fluid">
                <div class="navbar-header">
                  <a class="navbar-brand" href="https://www.pareto.network"><img src="static/images/LogoReverse.svg" width="150"/></a>
                </div>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <!-- <button id="access-toggle" type="button" class="btn btn-info" style="background-color:#6ec378;" onClick="revert()">Disconnect</button> -->
                    </li>
                </ul>
              </div>
            </nav>
        </div>

        <div class="container" style="background: white; min-height: 100vh;">
            <img src="static/images/pareto-info.png" style="margin-top: 30px; z-index: 1;"/>

            <!-- <button id="access-only" type="button" class="btn btn-info font-body" style="background-color:#6ec378; z-index:2;" onClick="revert()">Access</button> -->
            <!-- my intel feed, add user management elements later -->
            <!-- <div id="intel-feed" class="col col-lg-auto"> 

                // throw in data table, and then supplement with vue.js later
                <table id="pareto-content" class="table font-body" style="width:100%">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Body</th>
                                <th>Author</th>
                                <th>Reward</th>
                                <th>Block</th>
                            </tr>
                        </thead>

                    </table>

            </div> -->

        </div>

        <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script>

    </body>
    <script src="static/js/bundle.js"></script>
    <script>

        window.addEventListener('content', function (e){
          
          if($.fn.dataTable.isDataTable( '#pareto-content' )){
                table.destroy();
          }

          table = $('#pareto-content').DataTable({
                        responsive: true,
                        searching: false, 
                        paging: false, 
                        ordering: false, 
                        info: false,
                        scrollY: "100vh",
                        scrollCollapse : false,
                        ajax: {
                            url: '/v1/content'/*+'?rank='+rank+'&limit='+limit+'&page='+page*/,
                            dataSrc: ''
                        },
                        columns: [
                            { data : 'title'},
                            { 
                                data : 'body'
                            },
                            { data : 'address'},
                            { data : 'reward'},
                            { data : 'block'}
                        ]
                    });

        });

        window.addEventListener('revert', function(){
            //var accessValue = $("#access-toggle").value;
            //if(accessValue === "Disconnect"){

                //clear cookie and clear dashboard view and go back to access view

                 $.ajax({
                      method: 'POST',
                      url: '/v1/unsign',
                      body: {},
                      dataType: 'json',
                      success: function (data, textStatus, jqXHR) {

                        //if here then user authenticated, could also return address/user information.
                        $("#access-toggle").value = "Access";
                        console.log("no signature");

                      },
                      error: function (jqXHR, textStatus, errorThrown) {
                        console.log(errorThrown);
                      }
                  });
            /*} else {
                $("#access-toggle").value = "Disconnect";
                //sign
                //let event = new Event("sign");
                //window.dispatchEvent(event);

            }*/

        });

        $(document).ready(function() {

            $.ajax({
                  method: 'GET',
                  url: '/v1/auth',
                  dataType: 'json',
                  success: function (data, textStatus, jqXHR) {

                    //if here then user authenticated, could also return address/user information.

                    $("#access-toggle").value = "Disconnect";


                    window.dispatchEvent(new CustomEvent("content", { }));
                     $.fn.dataTableExt.errMode = 'ignore';

                  },
                  error: function (jqXHR, textStatus, errorThrown) {
                    console.log(errorThrown);

                    $("#access-toggle").value = "Access";
                  }
              });

        });

        function revert(){
            let event = new Event("revert");
            window.dispatchEvent(event);
        };

    </script>

    
    
</html>